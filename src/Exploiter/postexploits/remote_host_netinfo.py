from Identifier.networkinfo.ip_a_netinfo import ip_a_parse
from metasploit.msfrpc import MsfRpcClient


def remote_host_netinfo(client:MsfRpcClient, metasploitSessionNum:int):
    try:
        shell = client.sessions.session(metasploitSessionNum)
        shell.write("ip a")
        shell_output = shell.read()
        ips = ip_a_parse(shell_output)
        return 0, ips
    except:
        return -1, "[]"

