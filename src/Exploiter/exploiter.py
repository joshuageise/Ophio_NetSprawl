from metasploit.msfrpc import MsfRpcClient
import Exploiter.exploits as exploits
import Exploiter.postexploits as pexploits

def callExploit(client:MsfRpcClient, exploitName:str, targetIP:str):
    exploitMap = exploits.exploitMap
    exploitMap[exploitName](client, targetIP)
    return

def callPostExploit(client:MsfRpcClient, postExploitAction:str, sessionNum:int):
    pexploitMap = pexploits.PexploitMap
    return pexploitMap[postExploitAction](client, sessionNum)

def callPostExploitByIP(client:MsfRpcClient, postExploitAction, targetIP):
    sessions = client.sessions.list
    for session in sessions.keys():
        if sessions[session]["target_host"] == targetIP:
            return callPostExploit(client, postExploitAction, int(session))

def getSessionbyIP(client:MsfRpcClient, targetIP):
    sessions = client.sessions.list
    for session in sessions.keys():
        if session[session]["target_host"] == targetIP:
            return session
